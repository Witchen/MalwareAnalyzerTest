from time import sleep

import virtualbox

from VirtualboxManager.WindowsManager import *

vbox = virtualbox.VirtualBox()

vboxPath = "C:\Program Files\Oracle\VirtualBox"
machineName = "WIN-XP"
snapshotName = "VBox Additional Installed"

machine = vbox.find_machine(machineName)
progress = machine.launch_vm_process()
session = virtualbox.library.ISession(machine.create_session())

runlevel = ""
while runlevel != "Userland":
    if runlevel != str(session.console.guest.additions_run_level):
        runlevel = str(session.console.guest.additions_run_level)
        print "Current machine run status = " + runlevel

guestsession = session.console.guest.create_session("Dave", "mycomputer")

sleep(2)

session.console.keyboard.put_keys("mycomputer")
session.console.keyboard.put_keys(['ENTER'])

fromPath = "D:\To do list.zip"
toPath = "C:\Documents and Settings\Dave\Desktop\\"
copyFileToGuest(fromPath, toPath)

filePath = toPath + "To do list.zip"
password = "pass with space"
unzipFile(filePath, toPath, password)

# restoreSnapshot(vboxPath, machineName, snapshotName)